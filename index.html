<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cardano Text Explorer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome for GitHub brand icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>
<body>
  <div class="app">
    <header>
      <h1>Cardano Text Explorer</h1>
      <p>Fetch the latest transactions and surface any metadata text embedded on-chain.</p>
      <div class="badge-row">
        <span class="badge">Blockfrost API</span>
        <span class="badge">Mobile‑first</span>
        <span class="badge">Live chain data</span>
      </div>
    </header>

    <section class="panel">
      <div class="panel-title">Connection</div>
      <div class="form-row">
        <div class="field">
          <label for="network">Network</label>
          <select id="network">
            <option value="mainnet">Mainnet</option>
            <!--<option value="preprod">Preprod</option>-->
            <option value="preview">Preview</option>
          </select>
        </div>
        <div class="field">
          <label for="labelFilter">Metadata Label (optional)</label>
          <input
            id="labelFilter"
            type="text"
            placeholder="e.g. 674, 1990, myLabel"
            autocomplete="off"
          />
        </div>
        <div class="field">
          <label for="limit">Tx count (latest)</label>
          <input id="limit" type="number" min="1" max="20" value="20" />
        </div>
      </div>

      <!-- Enhanced Search Options -->
      <div class="form-row" style="margin-top:12px;">
        <div class="field">
          <label for="regexFilter">Text Regex (optional)</label>
          <input
            id="regexFilter"
            type="text"
            placeholder="e.g. ^Hello.*World$"
            autocomplete="off"
          />
        </div>
        <div class="field">
          <label for="walletFilter">Wallet Address (optional)</label>
          <input
            id="walletFilter"
            type="text"
            placeholder="stake or address"
            autocomplete="off"
          />
        </div>
      </div>

      <div class="form-row">
        <div class="field">
          <label for="dateFrom">Date From (optional)</label>
          <input id="dateFrom" type="date" />
        </div>
        <div class="field">
          <label for="dateTo">Date To (optional)</label>
          <input id="dateTo" type="date" />
        </div>
      </div>

      <div class="actions">
        <button id="fetchBtn">
          <span>Search</span>
      </button>

        <div class="field checkbox-field" style="margin-top:12px;">
          <label>
            <input type="checkbox" id="liveToggle" />
            Enable Live Updates
          </label>
  </div>

        <div class="field checkbox-field" style="margin-top:12px;">
          <label>
            <input type="checkbox" id="tailToggle" />
            Auto-scroll to newest results
          </label>
        </div>
      </div>
      <div id="status" class="status"></div>
    </section>

    <section class="panel">
      <div class="panel" style="margin-top:12px;">
        <div class="panel-title">View Options</div>
                <div class="actions" style="gap:12px; flex-wrap:wrap;">
          <button id="viewCardsBtn">Card View</button>
          <button id="viewUniqueBtn">Unique Metadata</button>
                    <button id="exportCSVBtn">Export CSV</button>
          <button id="exportJSONBtn">Export JSON</button>
                    <button id="saveSearchBtn">Save Search</button>
                    <div class="dropdown">
            <button id="loadSearchBtn" class="dropbtn">Load Saved ▾</button>
            <div id="savedSearchesDropdown" class="dropdown-content"></div>
          </div>
          <button id="customizeBtn" class="dropbtn">⚙️ Customize</button>
          <div id="customizeDropdown" class="dropdown-content customize-dropdown">
            <div class="customize-header">Show/Hide Fields</div>
            <label title="Show transaction hash"><input type="checkbox" data-field="txHash" checked> <code>Hash</code></label>
            <label title="Show metadata item count"><input type="checkbox" data-field="metaCount" checked> <code>Count</code></label>
            <label title="Show wallet addresses involved"><input type="checkbox" data-field="wallet"> <code>Wallet</code></label>
            <label title="Show metadata label number"><input type="checkbox" data-field="label" checked> <code>Label</code></label>
            <label title="Show extracted text values"><input type="checkbox" data-field="text" checked> <code>Text</code></label>
            <label title="Show block timestamp"><input type="checkbox" data-field="blockTime" checked> <code>Time</code></label>
          </div>
          <button id="helpBtn" class="help-btn">?</button>
        </div>
      </div>

      <!-- Unique metadata textarea (hidden by default) -->
      <div id="uniqueContainer" class="panel" style="display:none;">
        <div class="panel-title">Unique Metadata</div>
        <div style="position:relative;">
          <textarea id="uniqueText" style="
            width:100%;
            height:200px;
            border-radius:12px;
            padding:10px;
            background:#0f172a;
            color:#e5e7eb;
            border:1px solid rgba(148,163,184,0.4);
            font-size:0.8rem;
            white-space:pre-wrap;
            padding-right: 36px;
          "></textarea>
          <button class="copy-area-btn" title="Copy all text" style="
            position:absolute;
            top:8px;
            right:8px;
            width:28px;
            height:24px;
            border:none;
            background:rgba(148,163,184,0.2);
            border-radius:6px;
            cursor:pointer;
            color:var(--text);
            display:flex;
            align-items:center;
            justify-content:center;
          " data-target="uniqueText">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
          </button>
        </div>
      </div>

      <!-- Statistics Panel -->
      <div id="statsPanel" class="panel" style="display:none;">
        <div class="panel-title">Statistics</div>
        <div class="stats-grid" id="statsGrid"></div>
      </div>
      <div class="results-header">
        <h2>Results</h2>
        <span id="summary">No data yet.</span>
      </div>
      <div id="results" class="result-list"></div>
      <button id="loadMoreBtn" style="margin-top:10px; display:none;">
        Load More
      </button>
    </section>

        <!-- Sticky GitHub link fixed to viewport bottom-right -->
    <a class="github-sticky" href="https://github.com/primaryobjects/cardano-text-explorer" target="_blank" rel="noopener noreferrer" aria-label="View on GitHub">
      <i class="fa-brands fa-github" aria-hidden="true"></i>
      <span>View on GitHub</span>
    </a>

    <!-- Sticky Donation link fixed to viewport bottom-left -->
    <a class="donation-sticky" href="cardano:addr1v9dudaytpa2anpn32namwpggeyvf9s44akv7c87l4uy28lstxpdjt" title="Donate Cardano" aria-label="Donate">
      <i class="fa-solid fa-heart" aria-hidden="true"></i>
      <span>Donate</span>
    </a>

    <!-- Help Modal -->
    <div id="helpModal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Keyboard Shortcuts</h3>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <table class="shortcuts-table">
            <tr>
              <td><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>S</kbd></td>
              <td>Save current search</td>
            </tr>
            <tr>
              <td><kbd>Ctrl</kbd> + <kbd>E</kbd></td>
              <td>Export to CSV</td>
            </tr>
            <tr>
              <td><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>E</kbd></td>
              <td>Export to JSON</td>
            </tr>
            <tr>
              <td><kbd>Ctrl</kbd> + <kbd>F</kbd></td>
              <td>Focus label filter</td>
            </tr>
          </table>
          <h4>Features</h4>
          <ul class="features-list">
            <li><strong>Regex Filter:</strong> Search metadata text with regular expressions</li>
            <li><strong>Wallet Filter:</strong> Filter transactions by wallet address</li>
            <li><strong>Date Range:</strong> Filter by transaction date</li>
            <li><strong>Export:</strong> Download results as CSV or JSON</li>
            <li><strong>Save Search:</strong> Save filter configurations for reuse</li>
            <li><strong>Statistics:</strong> Real-time stats on results</li>
          </ul>
        </div>
      </div>
    </div>

  </div>

  <script src="script.js" defer></script>
</body>
</html>

